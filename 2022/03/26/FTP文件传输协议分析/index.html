<!DOCTYPE html><html lang="zh-CN"><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description" content=""><title>FTP文件传输协议分析 | Misaka's blog</title><link rel="stylesheet" type="text/css" href="/css/style.css?v=1.0.0"><link rel="stylesheet" type="text/css" href="//lib.baomitu.com/normalize/latest/normalize.min.css"><link rel="stylesheet" type="text/css" href="//lib.baomitu.com/pure/latest/pure-min.min.css"><link rel="stylesheet" type="text/css" href="//lib.baomitu.com/pure/latest/grids-responsive-min.min.css"><link rel="stylesheet" href="//lib.baomitu.com/font-awesome/4.7.0/css/font-awesome.min.css"><script type="text/javascript" src="//lib.baomitu.com/jquery/latest/jquery.min.js"></script><link rel="icon" mask="" sizes="any" href="/favicon.ico"><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.ico"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon.png"><link rel="alternate" type="application/atom+xml" href="/atom.xml"><script type="text/javascript" src="//lib.baomitu.com/clipboard.js/latest/clipboard.min.js"></script><script type="text/javascript" src="//lib.baomitu.com/toastr.js/latest/toastr.min.js"></script><link rel="stylesheet" href="//lib.baomitu.com/toastr.js/latest/toastr.min.css"><script async="" src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><script>(adsbygoogle = window.adsbygoogle || []).push({google_ad_client: "ca-pub-5060306535186583", enable_page_level_ads: true});</script><meta name="generator" content="Hexo 6.0.0"></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">FTP文件传输协议分析</h1><a id="logo" href="/.">Misaka's blog</a><p class="description"></p></div><div id="nav-menu"><a class="current" href="/."><i class="fa fa-home"> 首页</i></a><a href="/archives/"><i class="fa fa-archive"> 归档</i></a><a href="/about/"><i class="fa fa-user"> 关于</i></a><a href="/atom.xml"><i class="fa fa-rss"> 订阅</i></a><a href="/messageboard/"><i class="fa fa fa-comments"> 留言版</i></a><a href="/link/"><i class="fa fa fa-external-link"> 友链</i></a></div></div><div class="pure-g" id="layout"><div class="pure-u-1 pure-u-md-3-4"><div class="content_container"><div class="post"><h1 class="post-title">FTP文件传输协议分析</h1><div class="post-meta">2022-03-26<span id="busuanzi_container_page_pv"> | <span id="busuanzi_value_page_pv"></span><span> 阅读</span></span><span class="post-time"><span class="post-meta-item-text"> | </span><span class="post-meta-item-icon"><i class="fa fa-keyboard-o"></i><span class="post-count"> 4.5k</span><span class="post-meta-item-text"> 字</span></span></span><span class="post-time"> | <span class="post-meta-item-icon"><i class="fa fa-clock-o"></i><span class="post-count"> 19</span><span class="post-meta-item-text"> 分钟</span></span></span></div><div class="post-content"><h2 id="安装-FTP">安装 FTP</h2>
<ol>
<li>
<p>在服务器上安装 <code>vsftpd</code> 这个 <code>ftp</code> 客户端</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get install vsftpd</span><br></pre></td></tr></table></figure>
</li>
<li>
<p>修改登录和对匿名用户的设置</p>
<p><code>/etc/vsftpd.conf</code>文件如下：</p>
 <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">write_enable=YES             	//是否对登录用户开启写权限。属全局性设置。默认NO</span><br><span class="line">local_enable=YES             	//是否允许本地用户登录FTP服务器。默认为NO</span><br><span class="line">anonymous_enable=YES       		//设置是否允许匿名用户登录FTP服务器。默认为YES</span><br><span class="line">ftp_username=ftp                //定义匿名用户的账户名称，默认值为ftp。</span><br><span class="line">no_anon_password=YES        	//匿名用户登录时是否询问口令。设置为YES，则不询问。默 认NO</span><br><span class="line">anon_world_readable_only=YES    //匿名用户是否允许下载可阅读的文档，默认为YES。</span><br><span class="line">anon_upload_enable=YES      	//是否允许匿名用户上传文件。只有在write_enable设置</span><br><span class="line">local_root=/var/ftp         	// 设置本地用户登录后所在的目录。默认配置文件中没有设置该项，此时用户登录FTP服务器后，所在的目录为该用户的主目录，对于root用户，则为/root目录。</span><br><span class="line">anon_root=/var/ftp      		//设置匿名用户登录后所在的目录。若未指定，则默认为/var/ftp目录。</span><br><span class="line">chroot_list_enable=YES          // 设置是否启用chroot_list_file配置项指定的用户列表文件。设置为YES则除了列在j/etc/vsftpd/chroot_list文件中的的帐号外，所有登录的用户都可以进入ftp根目录之外的目录。默认NO </span><br></pre></td></tr></table></figure>
<p>我们只需要修改其中这一项：</p>
 <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">#write_enable=YES</span><br></pre></td></tr></table></figure>
<p>将 <code>#</code> 号去掉即可添加使 FTP 用户对目录进行写操作的权限</p>
</li>
<li>
<p>可以事分别先在客户端和服务器端准备两个文件进行传输使用</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">wget http://gaia.cs.umass.edu/wireshark-labs/alice.txt</span><br><span class="line">wget https://web.stanford.edu/class/cs144/vm_howto/setup_dev_env.sh</span><br></pre></td></tr></table></figure>
</li>
</ol>
<h2 id="使用-FTP">使用 FTP</h2>
<ul>
<li>
<p>接下来打开 <code>wireshark</code> 按照如下操作进行文件的上传和下载：</p>
<ol>
<li>在客户端中输入 <code>ftp ipadderss</code>,连接客户端</li>
<li>输入<code>FTP</code>用户名</li>
<li>输入 FTP 用户密码</li>
<li>使用 <code>ls</code> 指令，查看当前目录文件</li>
<li>在服务器端 查看当前目录文件</li>
<li>将客户端的文件 <code>alice.txt</code> 上传到服务器端，对应命令为 <code>put alice.txt</code></li>
<li>等待上传结束后，在服务器端输入 <code>ls</code> 指令，可以看到比传输开始之前多了一个 <code>alice.txt</code> 的文件</li>
<li>将服务器端的  <code>setup_dev_env.sh</code> 下载下来，对应的命令为 <code>get setup_dev_env.sh</code></li>
<li>关闭客户端与服务器的连接，对应命令为 <code>close</code></li>
<li>退出 <code>FTP</code> 程序， 命令为 <code>quit</code></li>
</ol>
<p><img src="https://cdn.jsdelivr.net/gh/Misaka-9982-coder/img_hosting/img/image-20220326182400695.png" alt="image-20220326182400695"></p>
<ol start="11">
<li>可以看到客户端多了个 <code>setup_dev_env.sh</code> 文件</li>
</ol>
<p><img src="https://cdn.jsdelivr.net/gh/Misaka-9982-coder/img_hosting/img/image-20220326182521239.png" alt="image-20220326182521239"></p>
</li>
</ul>
<h2 id="数据包分析">数据包分析</h2>
<p>在<code>wireshark</code> 的过滤规则中输入 <code>ip.addr == 192.168.0.101 &amp;&amp; ip.addr == 192.168.0.112 &amp;&amp; tcp</code></p>
<p>可以看到，在FTP的文件传输协议开始使用之前，客户端和服务器会先进行三次握手以建立TCP连接，在服务器端发送给客户端的第一个FTP协议报文的TCP状态标识为<code>PSH</code>,表示有数据传输。</p>
<p><img src="https://cdn.jsdelivr.net/gh/Misaka-9982-coder/img_hosting/img/image-20220326192425864.png" alt="image-20220326192425864"></p>
<p>其中，41号报文，43号报文，44号报文分别如下图所示，可以看出，服务器端与客户端进行通信的端口号分别为 <code>21</code> 和 <code>59353</code></p>
<p>端口 <code>21</code>用于传输控制流，并且是命令通向 <code>ftp</code> 服务器的进口，这里是用来打开服务器端口与客户端进行通信</p>
<p><img src="https://cdn.jsdelivr.net/gh/Misaka-9982-coder/img_hosting/img/image-20220326190457520.png" alt="image-20220326190457520"></p>
<p><img src="https://cdn.jsdelivr.net/gh/Misaka-9982-coder/img_hosting/img/image-20220326190511474.png" alt="image-20220326190511474"></p>
<p><img src="https://cdn.jsdelivr.net/gh/Misaka-9982-coder/img_hosting/img/image-20220326190524785.png" alt="image-20220326190524785"></p>
<p>在 <code>wireshark</code>的过滤规则中输入 <code>ip.addr == 192.168.0.101 &amp;&amp; ip.addr == 192.168.0.112 &amp;&amp; ftp</code>,可以得到如下图所示的数据流图</p>
<p><img src="https://cdn.jsdelivr.net/gh/Misaka-9982-coder/img_hosting/img/image-20220326192940293.png" alt="image-20220326192940293"></p>
<h3 id="登陆用户">登陆用户</h3>
<p><img src="https://cdn.jsdelivr.net/gh/Misaka-9982-coder/img_hosting/img/image-20220326225834696.png" alt="image-20220326225834696"></p>
<ol>
<li>
<p>45号报文中的 FTP如下所示，其中状态码 220 表示服务器准备就绪</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">File Transfer Protocol (FTP)</span><br><span class="line">   220 (vsFTPd 3.0.3)\r\n</span><br><span class="line">      Response code: Service ready for new user (220)</span><br><span class="line">      Response arg: (vsFTPd 3.0.3)</span><br><span class="line">[Current working directory: ]</span><br></pre></td></tr></table></figure>
<p>客户端则显示：<code>220 (vsFTPd 3.0.3)</code></p>
</li>
<li>
<p>47号报文的 FTP 记录了客户端输入用户名发送到服务器端，并且明文显示系统需要登陆的用户名</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">File Transfer Protocol (FTP)</span><br><span class="line">   USER misaka\r\n</span><br><span class="line">      Request command: USER</span><br><span class="line">      Request arg: misaka</span><br></pre></td></tr></table></figure>
</li>
<li>
<p>49号报文：输入用户名后，服务器响应状态码 331， 表示要求密码</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">File Transfer Protocol (FTP)</span><br><span class="line">   331 Please specify the password.\r\n</span><br><span class="line">      Response code: User name okay, need password (331)</span><br><span class="line">      Response arg: Please specify the password.</span><br></pre></td></tr></table></figure>
</li>
<li>
<p>52号报文：客户端输入密码发送给服务器端，明文传输</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">File Transfer Protocol (FTP)</span><br><span class="line">   PASS ********\r\n</span><br><span class="line">      Request command: PASS</span><br><span class="line">      Request arg: ********</span><br></pre></td></tr></table></figure>
</li>
<li>
<p>54号报文：服务器端收到密码后，返回给客户端 230 号状态码，表示用户登录，请继续。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">File Transfer Protocol (FTP)</span><br><span class="line">   230 Login successful.\r\n</span><br><span class="line">      Response code: User logged in, proceed (230)</span><br><span class="line">      Response arg: Login successful.</span><br></pre></td></tr></table></figure>
</li>
</ol>
<h3 id="LIST-命令">LIST 命令</h3>
<p><img src="https://cdn.jsdelivr.net/gh/Misaka-9982-coder/img_hosting/img/image-20220326225953691.png" alt="image-20220326225953691"></p>
<ol>
<li>
<p>56号报文：是客户端中输入 <code>ls</code> 命令时的发送给服务器端的接受数据的激活端口号为 <code>59354</code></p>
<p>此时，服务器与客户端通信的TCP为：<code>Transmission Control Protocol, Src Port: 59353, Dst Port: 21, Seq: 29, Ack: 78, Len: 28</code>， 仍然是 <code>59353</code> 和 <code>21</code> 号端口</p>
<p><code>Command frame: 60</code> : 表示对应的命令在 60 号数据报正式发出</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">File Transfer Protocol (FTP)</span><br><span class="line">   PORT 192,168,0,101,231,218\r\n</span><br><span class="line">      Request command: PORT</span><br><span class="line">      Request arg: 192,168,0,101,231,218</span><br><span class="line">      Active IP address: 192.168.0.101</span><br><span class="line">      Active port: 59354</span><br><span class="line">[Current working directory: ]</span><br><span class="line">[Command: LIST]</span><br><span class="line">[Command frame: 60]</span><br></pre></td></tr></table></figure>
</li>
<li>
<p>58号报文：服务器端响应状态码200，表示命令没问题，在客户端显示为<code>200 PORT command successful. Consider using PASV.</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">File Transfer Protocol (FTP)</span><br><span class="line">   200 PORT command successful. Consider using PASV.\r\n</span><br><span class="line">      Response code: Command okay (200)</span><br><span class="line">      Response arg: PORT command successful. Consider using PASV.</span><br></pre></td></tr></table></figure>
</li>
<li>
<p>60号报文：客户端对服务器发起的命令为 <code>LIST</code></p>
<p><code>Command response first frame</code>表示响应该命令的第一个数据帧为 66号</p>
<p><code>Command response last frame</code>表示响应该命令的最后一个数据帧为 66号</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">File Transfer Protocol (FTP)</span><br><span class="line">   LIST\r\n</span><br><span class="line">      Request command: LIST</span><br><span class="line">[Current working directory: ]</span><br><span class="line">[Command response frames: 1]</span><br><span class="line">[Command response bytes: 659]</span><br><span class="line">[Command response first frame: 66]</span><br><span class="line">[Command response last frame: 66]</span><br><span class="line">[Setup frame: 56]</span><br></pre></td></tr></table></figure>
</li>
<li>
<p>72号数据报：服务器发送给客户端的状态码为226，表示请求的文件操作成功，并正在关闭数据连接</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">File Transfer Protocol (FTP)</span><br><span class="line">    226 Directory send OK.\r\n</span><br><span class="line">        Response code: Closing data connection (226)</span><br><span class="line">        Response arg: Directory send OK.</span><br></pre></td></tr></table></figure>
</li>
<li>
<p>66 号 数据帧如下所示，其中，红色方框内的内容与客户端显示的东西刚好对应，是明文传输<br>
数据报：</p>
<p><img src="https://cdn.jsdelivr.net/gh/Misaka-9982-coder/img_hosting/img/image-20220326205935736.png" alt="image-20220326205935736"></p>
<p>客户端：</p>
<p><img src="https://cdn.jsdelivr.net/gh/Misaka-9982-coder/img_hosting/img/image-20220326210407981.png" alt="image-20220326210407981"></p>
</li>
</ol>
<h3 id="PUT操作">PUT操作</h3>
<p><img src="https://cdn.jsdelivr.net/gh/Misaka-9982-coder/img_hosting/img/image-20220326230105407.png" alt="image-20220326230105407"></p>
<ol>
<li>
<p>85号数据报：是客户端中输入 <code>put alice.txt</code> 命令时的发送给服务器端的接受数据的激活端口号为 <code>59355</code></p>
<p><code>Command response first frame</code>表示响应该命令的第一个数据帧为 95 号</p>
<p><code>Command response last frame</code>表示响应该命令的最后一个数据帧为 217 号</p>
<p><code>Command frame: 85</code> 表示对应的命令在 85 号数据报正式发出</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">Transmission Control Protocol, Src Port: 59353, Dst Port: 21, Seq: 63, Ack: 192, Len: 28</span><br><span class="line">File Transfer Protocol (FTP)</span><br><span class="line">    PORT 192,168,0,101,231,219\r\n</span><br><span class="line">        Request command: PORT</span><br><span class="line">        Request arg: 192,168,0,101,231,219</span><br><span class="line">        Active IP address: 192.168.0.101</span><br><span class="line">        Active port: 59355</span><br><span class="line">[Current working directory: ]</span><br><span class="line">[Command response frames: 108]</span><br><span class="line">[Command response bytes: 155736]</span><br><span class="line">[Command response first frame: 95]</span><br><span class="line">[Command response last frame: 217]</span><br><span class="line">[Response duration: 303ms]</span><br><span class="line">[Response bitrate: 4111Kbps]</span><br><span class="line">[Setup frame: 85]</span><br><span class="line">[Command: PORT 192,168,0,101,231,219]</span><br><span class="line">[Command frame: 85]</span><br></pre></td></tr></table></figure>
</li>
<li>
<p>86号数据报：服务器端响应状态码200，表示命令没问题，在客户端显示为<code>200 PORT command successful. Consider using PASV.</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">File Transfer Protocol (FTP)</span><br><span class="line">    200 PORT command successful. Consider using PASV.\r\n</span><br><span class="line">        Response code: Command okay (200)</span><br><span class="line">        Response arg: PORT command successful. Consider using PASV.</span><br></pre></td></tr></table></figure>
</li>
<li>
<p>88号数据报：客户端发送给服务器端的FTP 命令为 STOR 表示接收数据并且在服务器站点保存为文件，<code>arg</code>为参数 ：<code>alice.txt</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">File Transfer Protocol (FTP)</span><br><span class="line">    STOR alice.txt\r\n</span><br><span class="line">        Request command: STOR</span><br><span class="line">        Request arg: alice.txt</span><br></pre></td></tr></table></figure>
</li>
<li>
<p>92号数据报：服务器端发送给客户端的状态码为 150，表示文件状态正常并即将打开数据连接。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">File Transfer Protocol (FTP)</span><br><span class="line">    150 Ok to send data.\r\n</span><br><span class="line">        Response code: File status okay; about to open data connection (150)</span><br><span class="line">        Response arg: Ok to send data.</span><br></pre></td></tr></table></figure>
</li>
<li>
<p>231号数据报：服务器发送给客户端的状态码为226，表示请求的文件操作成功，并正在关闭数据连接</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">File Transfer Protocol (FTP)</span><br><span class="line">    226 Transfer complete.\r\n</span><br><span class="line">        Response code: Closing data connection (226)</span><br><span class="line">        Response arg: Transfer complete.</span><br></pre></td></tr></table></figure>
</li>
<li>
<p>数据流的报文简略如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">95	29.695807	192.168.0.101	192.168.0.112	FTP-DATA	1514	FTP Data: 1448 bytes (PORT) (PORT 192,168,0,101,231,219)</span><br><span class="line">96	29.695812	192.168.0.101	192.168.0.112	FTP-DATA	1514	FTP Data: 1448 bytes (PORT) (PORT 192,168,0,101,231,219)</span><br><span class="line">97	29.695814	192.168.0.101	192.168.0.112	FTP-DATA	1514	FTP Data: 1448 bytes (PORT) (PORT 192,168,0,101,231,219)</span><br><span class="line">...</span><br><span class="line">217	29.997952	192.168.0.101	192.168.0.112	FTP-DATA	866	FTP Data: 800 bytes (PORT) (PORT 192,168,0,101,231,219)</span><br></pre></td></tr></table></figure>
<p>可以发现，数据最长为 <code>1514</code> 字节，其中有效数据为 <code>1448</code> 字节，其其余 <code>66</code> 个字节为首部信息总的长度</p>
<p><img src="https://cdn.jsdelivr.net/gh/Misaka-9982-coder/img_hosting/img/image-20220326214350928.png" alt="image-20220326214350928"></p>
</li>
</ol>
<h3 id="GET-操作">GET 操作</h3>
<p><img src="https://cdn.jsdelivr.net/gh/Misaka-9982-coder/img_hosting/img/image-20220326230223508.png" alt="image-20220326230223508"></p>
<ol>
<li>
<p>239号报文：是客户端中输入 <code>get setup_dev_env.sh</code> 命令时的发送给服务器端的接受数据的激活端口号为 <code>59356</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">File Transfer Protocol (FTP)</span><br><span class="line">    PORT 192,168,0,101,231,220\r\n</span><br><span class="line">        Request command: PORT</span><br><span class="line">        Request arg: 192,168,0,101,231,220</span><br><span class="line">        Active IP address: 192.168.0.101</span><br><span class="line">        Active port: 59356</span><br></pre></td></tr></table></figure>
</li>
<li>
<p>240号报文：服务器端响应状态码200，表示命令没问题，在客户端显示为<code>200 PORT command successful. Consider using PASV.</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">File Transfer Protocol (FTP)</span><br><span class="line">    200 PORT command successful. Consider using PASV.\r\n</span><br><span class="line">        Response code: Command okay (200)</span><br><span class="line">        Response arg: PORT command successful. Consider using PASV.</span><br></pre></td></tr></table></figure>
</li>
<li>
<p>242号报文: 客户端发送给服务器端的 <code>Request command</code> 为 <code>RETR</code>，<code>Request arg</code> 为 <code>setup_dev_env.sh</code>, 表示传输 <code>setup_dev_env.sh</code>文件副本</p>
<p><code>Command response first frame</code>表示响应该命令的第一个数据帧为 248 号</p>
<p><code>Command response last frame</code>表示响应该命令的最后一个数据帧为 249 号</p>
<p><code>Setup frame: 85</code> 表示是 239 号数据帧设置的命令</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">Transmission Control Protocol, Src Port: 59353, Dst Port: 21, Seq: 135, Ack: 340, Len: 23</span><br><span class="line">File Transfer Protocol (FTP)</span><br><span class="line">    RETR setup_dev_env.sh\r\n</span><br><span class="line">        Request command: RETR</span><br><span class="line">        Request arg: setup_dev_env.sh</span><br><span class="line">[Current working directory: ]</span><br><span class="line">[Command response frames: 2]</span><br><span class="line">[Command response bytes: 1515]</span><br><span class="line">[Command response first frame: 248]</span><br><span class="line">[Command response last frame: 249]</span><br><span class="line">[Response duration: 0ms]</span><br><span class="line">[Response bitrate: 4294967295Kbps]</span><br><span class="line">[Setup frame: 239]</span><br></pre></td></tr></table></figure>
</li>
<li>
<p>247号报文：服务器的 <code>Response code</code> 表示文件状态正常，即将打开数据连接</p>
<p>在客户端会显示出<code>150 Opening BINARY mode data connection for setup_dev_env.sh (1515 bytes).</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">File Transfer Protocol (FTP)</span><br><span class="line">    150 Opening BINARY mode data connection for setup_dev_env.sh (1515 bytes).\r\n</span><br><span class="line">        Response code: File status okay; about to open data connection (150)</span><br><span class="line">        Response arg: Opening BINARY mode data connection for setup_dev_env.sh (1515 bytes).</span><br></pre></td></tr></table></figure>
</li>
<li>
<p>255号报文:服务器发送给客户端的状态码为226，表示请求的文件操作成功，并正在关闭数据连接</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">File Transfer Protocol (FTP)</span><br><span class="line">    226 Transfer complete.\r\n</span><br><span class="line">        Response code: Closing data connection (226)</span><br><span class="line">        Response arg: Transfer complete.</span><br></pre></td></tr></table></figure>
</li>
<li>
<p>在过滤规则中输入<code>ip.addr == 192.168.0.101 &amp;&amp; ip.addr == 192.168.0.112 &amp;&amp; ftp-data</code>，数据连接发送的报文如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">248	50.915641	192.168.0.112	192.168.0.101	FTP-DATA	1514	FTP Data: 1448 bytes (PORT) (RETR setup_dev_env.sh)</span><br><span class="line">249	50.915641	192.168.0.112	192.168.0.101	FTP-DATA	133	FTP Data: 67 bytes (PORT) (RETR setup_dev_env.sh)</span><br></pre></td></tr></table></figure>
<p><img src="https://cdn.jsdelivr.net/gh/Misaka-9982-coder/img_hosting/img/image-20220326224632006.png" alt="image-20220326224632006"></p>
</li>
</ol>
<h3 id="关闭FTP">关闭FTP</h3>
<p><img src="https://cdn.jsdelivr.net/gh/Misaka-9982-coder/img_hosting/img/image-20220326230319584.png" alt="image-20220326230319584"></p>
<ol>
<li>
<p>269号报文:客户端发送给服务器的 FTP 命令 为 <code>QUIT</code>, 表示请求断开连接</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">File Transfer Protocol (FTP)</span><br><span class="line">    QUIT\r\n</span><br><span class="line">        Request command: QUIT</span><br></pre></td></tr></table></figure>
</li>
<li>
<p>270号报文:服务器响应的<code>Response code</code> 为 221，表示服务器正在关闭连接，客户端显示 <code>221 Goodbye.</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">File Transfer Protocol (FTP)</span><br><span class="line">    221 Goodbye.\r\n</span><br><span class="line">        Response code: Service closing control connection (221)</span><br><span class="line">        Response arg: Goodbye.</span><br></pre></td></tr></table></figure>
</li>
<li>
<p>在这之后服务器和客户端会经过一次四次挥手的过程关闭他们之间的通信</p>
<p><img src="https://cdn.jsdelivr.net/gh/Misaka-9982-coder/img_hosting/img/image-20220326232609750.png" alt="image-20220326232609750"></p>
</li>
</ol>
<h3 id="四次挥手">四次挥手</h3>
<ul>
<li>
<p>第一次挥手：</p>
<p><img src="https://cdn.jsdelivr.net/gh/Misaka-9982-coder/img_hosting/img/image-20220326233341641.png" alt="image-20220326233341641"></p>
<p>272号报文的信息：</p>
<ul>
<li><code>Source IP Address</code>: 192.168.0.112</li>
<li><code>Destination IP Address</code>: 192.168.0.101</li>
<li><code>Source Port</code>: 21</li>
<li><code>Destination Port</code>: 59353</li>
<li><code>Fin</code>: 1</li>
<li><code>Acknowledgment Number</code>： 2006995353 ，164（relative ack number）</li>
<li><code>Sequence Number</code>：1380144531， 454 （relative sequence number）</li>
</ul>
<p><img src="https://cdn.jsdelivr.net/gh/Misaka-9982-coder/img_hosting/img/image-20220326233552646.png" alt="image-20220326233552646"></p>
<p>TCP连接释放报文段首部中</p>
<ul>
<li>终止位FIN和确认为ACK的值都被设置为1，表明这是一个TCP连接释放报文段，同时也对之前收到的报文段进行确认</li>
<li>序号seq字段的值设置为u，它等于TCP客户进程之前已传送过的数据的最后一个字节的序号加1</li>
<li>确认号ack字段的值设置为v，它等于TCP客户进程之前已收到的、数据的最后一个字节的序号加1</li>
</ul>
</li>
<li>
<p>第二次挥手：</p>
<p><img src="https://cdn.jsdelivr.net/gh/Misaka-9982-coder/img_hosting/img/image-20220326234431796.png" alt="image-20220326234431796"></p>
<p>273号报文的信息：</p>
<ul>
<li><code>Source IP Address</code>: 192.168.0.101</li>
<li><code>Destination IP Address</code>: 192.168.0.112</li>
<li><code>Source Port</code>: 59353</li>
<li><code>Destination Port</code>: 21</li>
<li><code>Acknowledgment Number</code>： 1380144532 ，455（relative ack number）是 272号报文的 <code>Sequence Number + 1</code></li>
<li><code>Sequence Number</code>：2006995353， 164 （relative sequence number）和 272号报文的<code>Acknowledgment Number</code>一致</li>
</ul>
<p><img src="https://cdn.jsdelivr.net/gh/Misaka-9982-coder/img_hosting/img/image-20220327000355701.png" alt="image-20220327000355701"></p>
<p>TCP服务器进程收到TCP连接释放报文段后，会发送一个普通的TCP确认报文段并进入关闭等待状态</p>
<p>普通的TCP确认报文段首部中</p>
<ul>
<li>确认位ACK的值被设置为1，表明这是一个普通的TCP确认报文段</li>
<li>序号seq字段的值设置为v，它等于TCP服务器进程之前已传送过的数据的最后一个字节的序号加1，这也与之前收到的TCP连接释放报文段中的确认号匹配</li>
<li>确认号ack字段的值设置为u+1，这是对TCP连接释放报文段的确认</li>
</ul>
<p><img src="https://cdn.jsdelivr.net/gh/Misaka-9982-coder/img_hosting/img/image-20220326235132461.png" alt="image-20220326235132461"></p>
<p>TCP客户进程收到TCP确认报文段后就进入终止等待2状态，等待TCP服务器进程发出的TCP连接释放报文段</p>
<p>若使用TCP服务器进程的应用进程已经没有数据要发送了，应用进程就通知其TCP服务器进程释放连接</p>
<p>由于TCP连接释放是由TCP客户进程主动发起的，因此TCP服务器进程对TCP连接的释放称为被动关闭连接</p>
</li>
<li>
<p>第三次挥手：</p>
<p><img src="https://cdn.jsdelivr.net/gh/Misaka-9982-coder/img_hosting/img/image-20220326234502526.png" alt="image-20220326234502526"></p>
<p>274号报文的信息：</p>
<ul>
<li><code>Source IP Address</code>: 192.168.0.101</li>
<li><code>Destination IP Address</code>: 192.168.0.112</li>
<li><code>Source Port</code>: 59353</li>
<li><code>Destination Port</code>: 21</li>
<li><code>Fin</code> ：1</li>
<li><code>Acknowledgment Number</code>： 1380144532 ，455（relative ack number）和 273 号报文的 <code>Acknowledgment Number</code> 一致</li>
<li><code>Sequence Number</code>：2006995353， 164 （relative sequence number）和 273 号报文的<code> Sequence Number</code> 一致</li>
</ul>
<p><img src="https://cdn.jsdelivr.net/gh/Misaka-9982-coder/img_hosting/img/image-20220326235159951.png" alt="image-20220326235159951"></p>
<p>TCP服务器进程发送TCP连接释放报文段并进入最后确认状态</p>
<p>该报文段首部中</p>
<ul>
<li>终止位FIN和确认位ACK的值都被设置为1，表明这是一个TCP连接释放报文段，同时也对之前收到的报文段进行确认</li>
<li>序号seq字段的值为w，这是因为在半关闭状态下，TCP服务器进程可能又发送</li>
<li>确认号ack字段的值为u+1，这是对之前收到的TCP连接释放报文段的重复确认</li>
</ul>
</li>
<li>
<p>第四次挥手：</p>
<p><img src="https://cdn.jsdelivr.net/gh/Misaka-9982-coder/img_hosting/img/image-20220326234526383.png" alt="image-20220326234526383"></p>
<p>275号报文的信息：</p>
<ul>
<li><code>Source IP Address</code>: 192.168.0.112</li>
<li><code>Destination IP Address</code>: 192.168.0.101</li>
<li><code>Source Port</code>: 21</li>
<li><code>Destination Port</code>: 59353</li>
<li><code>Acknowledgment Number</code>： 2006995354 ，165（relative ack number）是 274 号报文 的 <code>Sequence Number + 1</code></li>
<li><code>Sequence Number</code>：1380144532， 455 （relative sequence number）和 274 号报文 的 <code>Acknowledgment Number</code> 一致</li>
</ul>
<p><img src="https://cdn.jsdelivr.net/gh/Misaka-9982-coder/img_hosting/img/image-20220326235232827.png" alt="image-20220326235232827"></p>
<p>TCP客户进程收到TCP连接释放报文段后，必须针对该报文段发送普通的TCP确认报文段，之后进入时间等待状态</p>
<p>该报文段首部中</p>
<ul>
<li>确认为ACK的值被设置为1，表明这是一个普通的TCP确认报文段</li>
<li>序号seq字段的值设置为u+1，这是因为TCP客户进程之前发送的TCP连接释放报文段虽然不携带数据，但要消耗掉一个序号</li>
<li>确认号ack字段的值设置为w+1，这是对所收到的TCP连接释放报文段的确认</li>
</ul>
<p>TCP服务器进程收到该报文段后就进入关闭状态，而TCP客户进程还要进过2MSL后才能进入关闭状态</p>
</li>
</ul>
<h2 id="FTP命令：">FTP命令：</h2>
<table>
<thead>
<tr>
<th style="text-align:center">命令</th>
<th style="text-align:center"><a target="_blank" rel="noopener" href="https://zh.wikipedia.org/wiki/RFC">RFC</a></th>
<th style="text-align:center">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">ABOR</td>
<td style="text-align:center"></td>
<td style="text-align:center">(ABORT)此命令使服务器终止前一个FTP服务命令以及任何相关数据传输。</td>
</tr>
<tr>
<td style="text-align:center">ACCT</td>
<td style="text-align:center"></td>
<td style="text-align:center">(ACCOUNT)此命令的参数部分使用一个Telnet字符串来指明用户的账户。</td>
</tr>
<tr>
<td style="text-align:center">ADAT</td>
<td style="text-align:center"><a target="_blank" rel="noopener" href="https://tools.ietf.org/html/rfc2228">RFC 2228</a></td>
<td style="text-align:center">(AUTHENTICATION/SECURITY DATA)认证/安全数据</td>
</tr>
<tr>
<td style="text-align:center">ALLO</td>
<td style="text-align:center"></td>
<td style="text-align:center">为接收一个文件分配足够的磁盘空间</td>
</tr>
<tr>
<td style="text-align:center">APPE</td>
<td style="text-align:center"></td>
<td style="text-align:center">增加</td>
</tr>
<tr>
<td style="text-align:center">AUTH</td>
<td style="text-align:center"><a target="_blank" rel="noopener" href="https://tools.ietf.org/html/rfc2228">RFC 2228</a></td>
<td style="text-align:center">认证/安全机制</td>
</tr>
<tr>
<td style="text-align:center">CCC</td>
<td style="text-align:center"><a target="_blank" rel="noopener" href="https://tools.ietf.org/html/rfc2228">RFC 2228</a></td>
<td style="text-align:center">清除命令通道</td>
</tr>
<tr>
<td style="text-align:center">CDUP</td>
<td style="text-align:center"></td>
<td style="text-align:center">改变到父目录</td>
</tr>
<tr>
<td style="text-align:center">CONF</td>
<td style="text-align:center"><a target="_blank" rel="noopener" href="https://tools.ietf.org/html/rfc2228">RFC 2228</a></td>
<td style="text-align:center">机密性保护命令</td>
</tr>
<tr>
<td style="text-align:center">CWD</td>
<td style="text-align:center"></td>
<td style="text-align:center">改变工作目录</td>
</tr>
<tr>
<td style="text-align:center">DELE</td>
<td style="text-align:center"></td>
<td style="text-align:center">删除文件</td>
</tr>
<tr>
<td style="text-align:center">ENC</td>
<td style="text-align:center"><a target="_blank" rel="noopener" href="https://tools.ietf.org/html/rfc2228">RFC 2228</a></td>
<td style="text-align:center">隐私保护通道</td>
</tr>
<tr>
<td style="text-align:center">EPRT</td>
<td style="text-align:center"><a target="_blank" rel="noopener" href="https://tools.ietf.org/html/rfc2428">RFC 2428</a></td>
<td style="text-align:center">为服务器指定要连接的扩展地址和端口</td>
</tr>
<tr>
<td style="text-align:center">EPSV</td>
<td style="text-align:center"><a target="_blank" rel="noopener" href="https://tools.ietf.org/html/rfc2428">RFC 2428</a></td>
<td style="text-align:center">进入扩展被动模式</td>
</tr>
<tr>
<td style="text-align:center">FEAT</td>
<td style="text-align:center"><a target="_blank" rel="noopener" href="https://tools.ietf.org/html/rfc2389">RFC 2389</a></td>
<td style="text-align:center">获得服务器支持的特性列表</td>
</tr>
<tr>
<td style="text-align:center">HELP</td>
<td style="text-align:center"></td>
<td style="text-align:center">如果指定了命令，返回命令使用文档；否则返回一个通用帮助文档</td>
</tr>
<tr>
<td style="text-align:center">LANG</td>
<td style="text-align:center"><a target="_blank" rel="noopener" href="https://tools.ietf.org/html/rfc2640">RFC 2640</a></td>
<td style="text-align:center">语言协商</td>
</tr>
<tr>
<td style="text-align:center">LIST</td>
<td style="text-align:center"></td>
<td style="text-align:center">如果指定了文件或目录，返回其信息；否则返回当前工作目录的信息</td>
</tr>
<tr>
<td style="text-align:center">LPRT</td>
<td style="text-align:center"><a target="_blank" rel="noopener" href="https://tools.ietf.org/html/rfc1639">RFC 1639</a></td>
<td style="text-align:center">为服务器指定要连接的长地址和端口</td>
</tr>
<tr>
<td style="text-align:center">LPSV</td>
<td style="text-align:center"><a target="_blank" rel="noopener" href="https://tools.ietf.org/html/rfc1639">RFC 1639</a></td>
<td style="text-align:center">进入长被动模式</td>
</tr>
<tr>
<td style="text-align:center">MDTM</td>
<td style="text-align:center"><a target="_blank" rel="noopener" href="https://tools.ietf.org/html/rfc3659">RFC 3659</a></td>
<td style="text-align:center">返回指定文件的最后修改时间</td>
</tr>
<tr>
<td style="text-align:center">MIC</td>
<td style="text-align:center"><a target="_blank" rel="noopener" href="https://tools.ietf.org/html/rfc2228">RFC 2228</a></td>
<td style="text-align:center">完整性保护命令</td>
</tr>
<tr>
<td style="text-align:center">MKD</td>
<td style="text-align:center"></td>
<td style="text-align:center">创建目录</td>
</tr>
<tr>
<td style="text-align:center">MLSD</td>
<td style="text-align:center"><a target="_blank" rel="noopener" href="https://tools.ietf.org/html/rfc3659">RFC 3659</a></td>
<td style="text-align:center">如果目录被命名，列出目录的内容</td>
</tr>
<tr>
<td style="text-align:center">MLST</td>
<td style="text-align:center"><a target="_blank" rel="noopener" href="https://tools.ietf.org/html/rfc3659">RFC 3659</a></td>
<td style="text-align:center">提供命令行指定的对象的数据</td>
</tr>
<tr>
<td style="text-align:center">MODE</td>
<td style="text-align:center"></td>
<td style="text-align:center">设定传输模式（流、块或压缩）</td>
</tr>
<tr>
<td style="text-align:center">NLST</td>
<td style="text-align:center"></td>
<td style="text-align:center">返回指定目录的文件名列表</td>
</tr>
<tr>
<td style="text-align:center">NOOP</td>
<td style="text-align:center"></td>
<td style="text-align:center">无操作（哑包；通常用来保活）</td>
</tr>
<tr>
<td style="text-align:center">OPTS</td>
<td style="text-align:center"><a target="_blank" rel="noopener" href="https://tools.ietf.org/html/rfc2389">RFC 2389</a></td>
<td style="text-align:center">为特性选择选项</td>
</tr>
<tr>
<td style="text-align:center">PASS</td>
<td style="text-align:center"></td>
<td style="text-align:center">认证密码</td>
</tr>
<tr>
<td style="text-align:center">PASV</td>
<td style="text-align:center"></td>
<td style="text-align:center">进入被动模式</td>
</tr>
<tr>
<td style="text-align:center">PBSZ</td>
<td style="text-align:center"><a target="_blank" rel="noopener" href="https://tools.ietf.org/html/rfc2228">RFC 2228</a></td>
<td style="text-align:center">保护缓冲大小</td>
</tr>
<tr>
<td style="text-align:center">PORT</td>
<td style="text-align:center"></td>
<td style="text-align:center">指定服务器要连接的地址和端口</td>
</tr>
<tr>
<td style="text-align:center">PROT</td>
<td style="text-align:center"><a target="_blank" rel="noopener" href="https://tools.ietf.org/html/rfc2228">RFC 2228</a></td>
<td style="text-align:center">数据通道保护级别</td>
</tr>
<tr>
<td style="text-align:center">PWD</td>
<td style="text-align:center"></td>
<td style="text-align:center">打印工作目录，返回主机的当前目录</td>
</tr>
<tr>
<td style="text-align:center">QUIT</td>
<td style="text-align:center"></td>
<td style="text-align:center">断开连接</td>
</tr>
<tr>
<td style="text-align:center">REIN</td>
<td style="text-align:center"></td>
<td style="text-align:center">重新初始化连接</td>
</tr>
<tr>
<td style="text-align:center">REST</td>
<td style="text-align:center"></td>
<td style="text-align:center">从指定点重新开始传输</td>
</tr>
<tr>
<td style="text-align:center">RETR</td>
<td style="text-align:center"></td>
<td style="text-align:center">传输文件副本</td>
</tr>
<tr>
<td style="text-align:center">RMD</td>
<td style="text-align:center"></td>
<td style="text-align:center">删除目录</td>
</tr>
<tr>
<td style="text-align:center">RNFR</td>
<td style="text-align:center"></td>
<td style="text-align:center">从…重命名</td>
</tr>
<tr>
<td style="text-align:center">RNTO</td>
<td style="text-align:center"></td>
<td style="text-align:center">重命名到…</td>
</tr>
<tr>
<td style="text-align:center">SITE</td>
<td style="text-align:center"></td>
<td style="text-align:center">发送站点特殊命令到远端服务器</td>
</tr>
<tr>
<td style="text-align:center">SIZE</td>
<td style="text-align:center"><a target="_blank" rel="noopener" href="https://tools.ietf.org/html/rfc3659">RFC 3659</a></td>
<td style="text-align:center">返回文件大小</td>
</tr>
<tr>
<td style="text-align:center">SMNT</td>
<td style="text-align:center"></td>
<td style="text-align:center">挂载文件结构</td>
</tr>
<tr>
<td style="text-align:center">STAT</td>
<td style="text-align:center"></td>
<td style="text-align:center">返回当前状态</td>
</tr>
<tr>
<td style="text-align:center">STOR</td>
<td style="text-align:center"></td>
<td style="text-align:center">接收数据并且在服务器站点保存为文件</td>
</tr>
<tr>
<td style="text-align:center">STOU</td>
<td style="text-align:center"></td>
<td style="text-align:center">唯一地保存文件</td>
</tr>
<tr>
<td style="text-align:center">STRU</td>
<td style="text-align:center"></td>
<td style="text-align:center">设定文件传输结构</td>
</tr>
<tr>
<td style="text-align:center">SYST</td>
<td style="text-align:center"></td>
<td style="text-align:center">返回系统类型</td>
</tr>
<tr>
<td style="text-align:center">TYPE</td>
<td style="text-align:center"></td>
<td style="text-align:center">设定传输模式（<a target="_blank" rel="noopener" href="https://zh.wikipedia.org/wiki/ASCII">ASCII</a>/<a target="_blank" rel="noopener" href="https://zh.wikipedia.org/wiki/%E4%BA%8C%E8%BF%9B%E5%88%B6%E6%96%87%E4%BB%B6">二进制</a>).</td>
</tr>
<tr>
<td style="text-align:center">USER</td>
<td style="text-align:center"></td>
<td style="text-align:center">认证用户名</td>
</tr>
<tr>
<td style="text-align:center">XCUP</td>
<td style="text-align:center"><a target="_blank" rel="noopener" href="https://tools.ietf.org/html/rfc775">RFC 775</a></td>
<td style="text-align:center">改变之当前工作目录的父目录</td>
</tr>
<tr>
<td style="text-align:center">XMKD</td>
<td style="text-align:center"><a target="_blank" rel="noopener" href="https://tools.ietf.org/html/rfc775">RFC 775</a></td>
<td style="text-align:center">创建目录</td>
</tr>
<tr>
<td style="text-align:center">XPWD</td>
<td style="text-align:center"><a target="_blank" rel="noopener" href="https://tools.ietf.org/html/rfc775">RFC 775</a></td>
<td style="text-align:center">打印当前工作目录</td>
</tr>
<tr>
<td style="text-align:center">XRCP</td>
<td style="text-align:center"><a target="_blank" rel="noopener" href="https://tools.ietf.org/html/rfc743">RFC 743</a></td>
<td style="text-align:center"></td>
</tr>
<tr>
<td style="text-align:center">XRMD</td>
<td style="text-align:center"><a target="_blank" rel="noopener" href="https://tools.ietf.org/html/rfc775">RFC 775</a></td>
<td style="text-align:center">删除目录</td>
</tr>
<tr>
<td style="text-align:center">XRSQ</td>
<td style="text-align:center"><a target="_blank" rel="noopener" href="https://tools.ietf.org/html/rfc743">RFC 743</a></td>
<td style="text-align:center"></td>
</tr>
<tr>
<td style="text-align:center">XSEM</td>
<td style="text-align:center"><a target="_blank" rel="noopener" href="https://tools.ietf.org/html/rfc737">RFC 737</a></td>
<td style="text-align:center">发送，否则邮件</td>
</tr>
<tr>
<td style="text-align:center">XSEN</td>
<td style="text-align:center"><a target="_blank" rel="noopener" href="https://tools.ietf.org/html/rfc737">RFC 737</a></td>
<td style="text-align:center">发送到终端</td>
</tr>
</tbody>
</table>
<h2 id="FTP响应码：">FTP响应码：</h2>
<p><a target="_blank" rel="noopener" href="https://www.w3.org/Protocols/rfc959/4_FileTransfer.html">https://www.w3.org/Protocols/rfc959/4_FileTransfer.html</a></p>
<h2 id="参考资料-3">参考资料</h2>
<ul>
<li>
<p><a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/File_Transfer_Protocol">https://en.wikipedia.org/wiki/File_Transfer_Protocol</a></p>
</li>
<li>
<p><a target="_blank" rel="noopener" href="https://www.w3.org/Protocols/rfc959/4_FileTransfer.html">https://www.w3.org/Protocols/rfc959/4_FileTransfer.html</a></p>
</li>
<li>
<p><a target="_blank" rel="noopener" href="http://docs.52im.net/extend/docs/book/tcpip/vol1/27/">http://docs.52im.net/extend/docs/book/tcpip/vol1/27/</a></p>
</li>
</ul>
</div><div class="tags"><a href="/tags/Network"><i class="fa fa-tag">Network</i></a><a href="/tags/Wireshark"><i class="fa fa-tag">Wireshark</i></a></div><div class="post-nav"><a class="pre" href="/2022/05/19/CS61A-Homework-3/">CS61A Homework 3</a><a class="next" href="/2022/03/21/Wireshark%E5%9F%BA%E6%9C%AC%E4%BD%BF%E7%94%A8/">Wireshark基本使用</a></div><div id="tcomment"></div><script src="https://unpkg.com/twikoo@1.5.7/dist/twikoo.all.min.js"></script><script>twikoo.init({
  envId: 'https://twikoo-f8467x06b-misaka-9982-coder.vercel.app/',
  el: '#tcomment',
  region: '',
  path: ''
})</script></div></div></div><div class="pure-u-1-4 hidden_mid_and_down"><div id="sidebar"><div class="widget"><div class="search-form"><input id="local-search-input" placeholder="Search" type="text" name="q" results="0"/><div id="local-search-result"></div></div></div><div class="widget"><div class="author-info"><a class="info-avatar" href="/about/" title="关于"><img class="nofancybox" src="/img/avatar.jpeg"/></a><p>Try to be better.</p><a class="info-icon" href="https://twitter.com/Misaka___9982" title="Twitter" target="_blank" style="margin-inline:5px"> <i class="fa fa-twitter-square" style="margin-inline:5px"></i></a><a class="info-icon" href="mailto:1784321894@qq.com" title="Email" target="_blank" style="margin-inline:5px"> <i class="fa fa-envelope-square" style="margin-inline:5px"></i></a><a class="info-icon" href="https://github.com/Misaka-9982-coder" title="Github" target="_blank" style="margin-inline:5px"> <i class="fa fa-github-square" style="margin-inline:5px"></i></a><a class="info-icon" href="/atom.xml" title="RSS" target="_blank" style="margin-inline:5px"> <i class="fa fa-rss-square" style="margin-inline:5px"></i></a></div></div><div class="widget"><div class="widget-title"><i class="fa fa-folder-o"> 分类</i></div><ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/%E7%AE%97%E6%B3%95/">算法</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-star-o"> 标签</i></div><div class="tagcloud"><a href="/tags/OS/" style="font-size: 15px;">OS</a> <a href="/tags/6-S081/" style="font-size: 15px;">6.S081</a> <a href="/tags/Acwing/" style="font-size: 15px;">Acwing</a> <a href="/tags/Algorithm/" style="font-size: 15px;">Algorithm</a> <a href="/tags/CS144/" style="font-size: 15px;">CS144</a> <a href="/tags/Network/" style="font-size: 15px;">Network</a> <a href="/tags/CS188/" style="font-size: 15px;">CS188</a> <a href="/tags/AI/" style="font-size: 15px;">AI</a> <a href="/tags/CS61A/" style="font-size: 15px;">CS61A</a> <a href="/tags/CS61BL/" style="font-size: 15px;">CS61BL</a> <a href="/tags/Java/" style="font-size: 15px;">Java</a> <a href="/tags/Wireshark/" style="font-size: 15px;">Wireshark</a></div></div><div class="widget"><div class="widget-title"><i class="fa fa-file-o"> 最近文章</i></div><ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2023/06/28/Codewar-%E4%BD%93%E9%AA%8C/">Codewar 体验</a></li><li class="post-list-item"><a class="post-list-link" href="/2023/03/15/6-S081-Lab-3-page-tables/">6.S081 Lab 3 page tables</a></li><li class="post-list-item"><a class="post-list-link" href="/2023/03/14/6-S081-Lab-2-System-Calls/">6.S081-Lab 2: System Calls</a></li><li class="post-list-item"><a class="post-list-link" href="/2023/03/10/6-S081-Lab-1-Xv6-and-Unix-utilities/">6.S081-Lab 1: Xv6 and Unix utilities</a></li><li class="post-list-item"><a class="post-list-link" href="/2023/03/09/6-S081%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE%E5%8F%8A%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/">6.S081环境配置及参考资料</a></li><li class="post-list-item"><a class="post-list-link" href="/2023/02/25/CS144-Lab7/">CS144-Lab7</a></li><li class="post-list-item"><a class="post-list-link" href="/2023/02/25/CS144-Lab6/">CS144-Lab6</a></li><li class="post-list-item"><a class="post-list-link" href="/2023/02/24/CS144-Lab5/">CS144-Lab5</a></li><li class="post-list-item"><a class="post-list-link" href="/2023/02/20/Makefile-%E5%92%8C-CMake/">Makefile 和 CMake</a></li><li class="post-list-item"><a class="post-list-link" href="/2023/02/19/CS144-Lab4/">CS144-Lab4</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-external-link"> 友情链接</i></div><ul></ul><a href="https://www.colopen-blog.com/" title="彩色铅笔" target="_blank">彩色铅笔</a><ul></ul><a href="https://www.selfknow.cn/" title="L2c" target="_blank">L2c</a><ul></ul><a href="https://blognas.hwb0307.com" title="浮云翩迁之间" target="_blank">浮云翩迁之间</a></div><div class="widget"><div class="widget-title"><i class="fa fa-heartbeat"> 访客地图</i></div></div><script id="clstr_globe" type="text/javascript" defer="defer" src="//clustrmaps.com/globe.js?d=NAGSI3cBPnTXd3xVo3V7zDC9xqeu_9ed2OCmGUj1uiw"></script><script src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" async="async"></script><div class="widget"><div class="widget-title"><i class="fa fa-tags"> 网站资讯</i></div><ul> </ul><div class="webinfo-item"><div class="item-name">本站访客数  : </div><div class="item-count" id="busuanzi_value_site_uv"></div></div><ul> </ul><div class="webinfo-item"><div class="item-name">本站总访问量  : </div><div class="item-count" id="busuanzi_value_site_pv"></div></div><ul></ul><div class="webinfo-item"><div class="item-name">本站总字数 : </div><div class="item-count">301k</div></div></div></div></div><div class="pure-u-1 pure-u-md-3-4"><div id="footer">Copyright © 2021 - 2023 <a href="/." rel="nofollow">Misaka's blog.</a> Powered by<a rel="nofollow" target="_blank" href="https://hexo.io"> Hexo.</a><a rel="nofollow" target="_blank" href="https://github.com/tufu9441/maupassant-hexo"> Theme</a> by<a rel="nofollow" target="_blank" href="https://github.com/pagecho"> Cho.</a></div></div></div><a class="show" id="rocket" href="#top"></a><script type="text/javascript" src="/js/totop.js?v=1.0.0" async></script><script type="text/javascript" src="//lib.baomitu.com/fancybox/latest/jquery.fancybox.min.js"></script><script type="text/javascript" src="/js/fancybox.js?v=1.0.0"></script><link rel="stylesheet" type="text/css" href="//lib.baomitu.com/fancybox/latest/jquery.fancybox.min.css"><link rel="stylesheet" type="text/css" href="/css/search.css?v=1.0.0"><script type="text/javascript" src="/js/search.js?v=1.0.0"></script><script>var search_path = 'search.xml';
if (search_path.length == 0) {
  search_path = 'search.xml';
}
var path = '/' + search_path;
searchFunc(path, 'local-search-input', 'local-search-result');
</script><script type="text/javascript" src="/js/copycode.js?v=1.0.0" successtext="复制成功！"></script><link rel="stylesheet" type="text/css" href="/css/copycode.css?v=1.0.0"><script type="text/javascript" src="/js/codeblock-resizer.js?v=1.0.0"></script><script type="text/javascript" src="/js/smartresize.js?v=1.0.0"></script></div></body></html>